Portions of this code are originallly from https://github.com/madskristensen/OpenCommandLine and licensed under the Apache License, Version 2.0 license. 